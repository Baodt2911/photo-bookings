<!DOCTYPE html>
<html
  lang="vi"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{admin/layout/admin-layout}"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Albums - Admin Panel</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link th:href="@{/css/tailwind.css}" rel="stylesheet" />
    <script src="/js/admin/album-management.js"></script>
  </head>
  <body>
    <div layout:fragment="content">
      <!-- Main Content -->
      <div class="min-h-screen bg-gray-50">
        <!-- Top Bar -->
        <div class="bg-white border-b border-gray-200 px-6 py-4">
          <div class="flex items-center justify-between">
            <!-- Left side - Sort and Display options -->
            <div class="flex items-center space-x-6">
              <div class="flex items-center space-x-2">
                <i class="fas fa-sort text-gray-500"></i>
                <span class="text-sm text-gray-700">Sắp xếp</span>
              </div>
              <div class="flex items-center space-x-2">
                <i class="fas fa-th text-gray-500"></i>
                <span class="text-sm text-gray-700">Cách hiển thị</span>
              </div>
            </div>

            <!-- Center - Statistics -->
            <div class="flex items-center space-x-8">
              <div class="text-sm text-gray-700">
                Tổng số album đã tạo:
                <span class="font-medium" th:text="${totalAlbums}">1</span>
              </div>
              <div class="text-sm text-gray-700">
                Số album tạo mới trong tháng này:
                <span class="font-medium">3/5</span>
              </div>
            </div>

            <!-- Right side - Search -->
            <div class="flex items-center">
              <div class="relative">
                <input
                  type="text"
                  placeholder="Tìm kiếm"
                  class="w-64 px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                />
                <i
                  class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"
                ></i>
              </div>
            </div>
          </div>
        </div>

        <!-- Albums Grid -->
        <div class="p-6">
          <div
            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
          >
            <!-- Create Album Card -->
            <div
              onclick="openAlbumModal()"
              class="bg-white rounded-xl shadow-sm border-2 border-dashed border-green-400 hover:border-green-500 transition-colors cursor-pointer group"
            >
              <div class="aspect-square flex items-center justify-center">
                <div class="text-center">
                  <div
                    class="w-16 h-16 mx-auto mb-4 rounded-full bg-green-100 flex items-center justify-center group-hover:bg-green-200 transition-colors"
                  >
                    <i class="fas fa-plus text-2xl text-green-600"></i>
                  </div>
                  <h3 class="text-lg font-medium text-gray-900">Tạo album</h3>
                </div>
              </div>
            </div>

            <!-- Existing Albums -->
            <div
              th:each="album : ${albums.content}"
              class="bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow cursor-pointer"
            >
              <div class="aspect-square relative overflow-hidden rounded-t-xl">
                <!-- Album Cover Image -->
                <div
                  th:if="${album.photos != null && !album.photos.isEmpty()}"
                  class="w-full h-full bg-cover bg-center"
                  th:style="'background-image: url(' + ${album.photos[0].url} + ')'"
                ></div>
                <!-- Default Image -->
                <div
                  th:unless="${album.photos != null && !album.photos.isEmpty()}"
                  class="w-full h-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center"
                >
                  <i class="fas fa-images text-white text-4xl"></i>
                </div>
              </div>

              <!-- Album Info -->
              <div class="p-4">
                <h3
                  class="text-lg font-medium text-gray-900 mb-1"
                  th:text="${album.name}"
                >
                  Album Name
                </h3>
                <p
                  class="text-sm text-gray-500 mb-3"
                  th:text="${#temporals.format(album.createdAt, 'dd-MM-yyyy')}"
                >
                  Ngày tạo: 22-09-2025
                </p>

                <!-- Album Stats -->
                <div class="flex items-center justify-between">
                  <div class="flex items-center space-x-4">
                    <div class="flex items-center text-gray-500">
                      <i class="fas fa-heart mr-1"></i>
                      <span class="text-sm">0</span>
                    </div>
                    <div class="flex items-center text-gray-500">
                      <i class="fas fa-comment mr-1"></i>
                      <span class="text-sm">0</span>
                    </div>
                  </div>
                  <div class="relative">
                    <button
                      class="text-gray-400 hover:text-gray-600 transition-colors"
                      onclick="event.stopPropagation(); showAlbumMenu(event, '${album.id}')"
                    >
                      <i class="fas fa-ellipsis-h"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Album Actions Dropdown -->
      <div
        id="albumMenuDropdown"
        class="fixed z-50 hidden bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-32"
      >
        <button
          id="editAlbumBtn"
          class="w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center"
        >
          <i class="fas fa-edit mr-2"></i>Chỉnh sửa
        </button>
        <button
          id="deleteAlbumBtn"
          class="w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center"
        >
          <i class="fas fa-trash mr-2"></i>Xóa
        </button>
      </div>

      <!-- Delete Confirmation Modal -->
      <div
        id="confirmModal"
        class="fixed inset-0 overflow-y-auto h-full w-full hidden z-50"
        style="background-color: rgba(0, 0, 0, 0.3)"
      >
        <div
          class="relative top-20 mx-auto p-5 w-96 shadow-2xl rounded-xl bg-white"
        >
          <div class="mt-3 text-center">
            <div
              class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4"
            >
              <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
            </div>
            <h3 class="text-lg font-medium text-gray-900 mb-2">Xác nhận xóa</h3>
            <p id="confirmMessage" class="text-sm text-gray-500 mb-6">
              Bạn có chắc chắn muốn xóa album này? Hành động này không thể hoàn
              tác.
            </p>
            <div class="flex justify-center space-x-3">
              <button
                onclick="closeConfirmModal()"
                class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors"
              >
                Hủy
              </button>
              <button
                id="confirmDeleteBtn"
                onclick="confirmDelete()"
                class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
              >
                Xóa
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Album Modal -->
      <div
        id="albumModal"
        class="fixed inset-0 overflow-y-auto h-full w-full hidden z-50"
        style="background-color: rgba(0, 0, 0, 0.3)"
      >
        <div
          class="relative top-20 mx-auto p-5 w-full max-w-xl shadow-2xl rounded-xl bg-white"
        >
          <div class="flex justify-between items-center mb-6">
            <h3 id="albumModalTitle" class="text-2xl font-bold text-red-600">
              Tạo album
            </h3>
            <button
              onclick="closeAlbumModal()"
              class="text-gray-400 hover:text-gray-600 transition-colors"
            >
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>

          <form id="albumForm" enctype="multipart/form-data">
            <input type="hidden" id="albumId" name="id" />

            <div class="space-y-6">
              <!-- Google Drive Link -->
              <div>
                <label
                  for="albumDriveFolderLink"
                  class="block text-sm font-medium text-gray-700 mb-2"
                >
                  <span class="text-red-500">*</span> Link ảnh Google Drive
                </label>
                <input
                  type="url"
                  id="albumDriveFolderLink"
                  name="driveFolderLink"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                  placeholder="Link Google Drive thư mục chứa ảnh vào đây"
                />
                <p class="text-xs text-gray-500 mt-2">
                  Để tối ưu tốc độ tải ảnh, vui lòng để kích thước ảnh nhỏ vừa
                  đủ để khách hàng của bạn có thể xem và chọn ảnh họ thích. (Gợi
                  ý: 720px hoặc 1080px cho cạnh dài)
                </p>
              </div>

              <!-- Album Name -->
              <div>
                <label
                  for="albumName"
                  class="block text-sm font-medium text-gray-700 mb-2"
                >
                  <span class="text-red-500">*</span> Tên album
                </label>
                <input
                  type="text"
                  id="albumName"
                  name="name"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                  placeholder="Tên album"
                />
              </div>

              <!-- Customer Name -->
              <div>
                <label
                  for="customerName"
                  class="block text-sm font-medium text-gray-700 mb-2"
                >
                  <span class="text-red-500">*</span> Tên khách hàng
                </label>
                <input
                  type="text"
                  id="customerName"
                  name="customerName"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                  placeholder="Tên khách hàng"
                />
              </div>

              <!-- Settings Grid -->
              <div class="space-y-4">
                <!-- Password Protect -->
                <div class="flex items-center">
                  <label class="text-sm font-medium text-gray-700 w-64">
                    Bảo vệ album bằng mật khẩu
                  </label>
                  <div class="flex items-center space-x-3">
                    <div class="relative">
                      <input
                        type="hidden"
                        name="passwordProtect"
                        value="false"
                      />
                      <input
                        type="checkbox"
                        id="albumPasswordProtect"
                        name="passwordProtect"
                        value="true"
                        class="sr-only"
                      />
                      <label
                        for="albumPasswordProtect"
                        class="block w-12 h-6 bg-gray-300 rounded-full cursor-pointer transition-colors"
                      >
                        <span
                          class="block w-5 h-5 bg-white rounded-full shadow transform transition-transform translate-x-0.5 translate-y-0.5"
                        ></span>
                      </label>
                    </div>
                    <input
                      type="password"
                      id="albumPassword"
                      name="password"
                      class="w-32 px-2 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none hidden text-xs"
                      placeholder="Mật khẩu"
                    />
                  </div>
                </div>

                <!-- Allow Comments -->
                <div class="flex items-center">
                  <label class="text-sm font-medium text-gray-700 w-64">
                    Cho phép bình luận
                  </label>
                  <div class="relative">
                    <input type="hidden" name="allowComment" value="false" />
                    <input
                      type="checkbox"
                      id="albumAllowComment"
                      name="allowComment"
                      value="true"
                      class="sr-only"
                    />
                    <label
                      for="albumAllowComment"
                      class="block w-12 h-6 bg-gray-300 rounded-full cursor-pointer transition-colors"
                    >
                      <span
                        class="block w-5 h-5 bg-white rounded-full shadow transform transition-transform translate-x-0.5 translate-y-0.5"
                      ></span>
                    </label>
                  </div>
                </div>

                <!-- Allow Download -->
                <div class="flex items-center">
                  <label class="text-sm font-medium text-gray-700 w-64">
                    Cho phép tải xuống
                    <i class="fas fa-info-circle text-gray-400 ml-1"></i>
                  </label>
                  <div class="relative">
                    <input type="hidden" name="allowDownload" value="false" />
                    <input
                      type="checkbox"
                      id="albumAllowDownload"
                      name="allowDownload"
                      value="true"
                      class="sr-only"
                    />
                    <label
                      for="albumAllowDownload"
                      class="block w-12 h-6 bg-gray-300 rounded-full cursor-pointer transition-colors"
                    >
                      <span
                        class="block w-5 h-5 bg-white rounded-full shadow transform transition-transform translate-x-0.5 translate-y-0.5"
                      ></span>
                    </label>
                  </div>
                </div>

                <!-- Limit Selection -->
                <div class="flex items-center">
                  <label class="text-sm font-medium text-gray-700 w-64">
                    Giới hạn số lượng ảnh được chọn
                  </label>
                  <div class="flex items-center space-x-3">
                    <div class="relative">
                      <input
                        type="hidden"
                        name="limitSelectionEnabled"
                        value="false"
                      />
                      <input
                        type="checkbox"
                        id="albumLimitSelectionEnabled"
                        name="limitSelectionEnabled"
                        value="true"
                        class="sr-only"
                      />
                      <label
                        for="albumLimitSelectionEnabled"
                        class="block w-12 h-6 bg-gray-300 rounded-full cursor-pointer transition-colors"
                      >
                        <span
                          class="block w-5 h-5 bg-white rounded-full shadow transform transition-transform translate-x-0.5 translate-y-0.5"
                        ></span>
                      </label>
                    </div>
                    <input
                      type="number"
                      id="albumLimitSelection"
                      name="limitSelection"
                      min="1"
                      class="w-32 px-2 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none hidden text-xs"
                      placeholder="Số lượng"
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Form Actions -->
            <div class="flex justify-end space-x-3 mt-8 pt-6 border-t">
              <button
                type="button"
                onclick="closeAlbumModal()"
                class="px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"
              >
                Hủy bỏ
              </button>
              <button
                type="submit"
                class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
              >
                Tạo ngay
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </body>
</html>
